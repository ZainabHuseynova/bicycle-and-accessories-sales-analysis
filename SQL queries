select * from product;
select * from subcategories;
select * from customers

--Which subcategory the products belong to
SELECT P.ProductKey, P.ProductName, S.SubcategoryName
FROM Product P
JOIN subcategories S ON P.ProductSubcategoryKey = S.ProductSubcategoryKey;


--Profit
SELECT ProductName, ProductCost, ProductPrice, 
(ProductPrice - ProductCost) AS Profit
FROM Product;


--Number of products belonging to each subcategory
SELECT p.ProductSubcategoryKey, s.SubcategoryName, COUNT(p.ProductKey) AS ProductCount
FROM Product p
JOIN Subcategories s ON p.ProductSubcategoryKey = s.ProductSubcategoryKey
GROUP BY p.ProductSubcategoryKey, s.SubcategoryName;


--Total revenue generated by each product category
SELECT S.SubcategoryName, SUM(P.ProductPrice) AS TotalRevenue
FROM Product P
JOIN Subcategories S ON P.ProductSubcategoryKey = S.ProductSubcategoryKey
GROUP BY S.SubcategoryName;


--Average prices for product categories
SELECT s.ProductCategoryKey, AVG(p.ProductPrice) AS AvgPrice
FROM Product p
JOIN Subcategories s ON p.ProductSubcategoryKey = s.ProductSubcategoryKey
GROUP BY s.ProductCategoryKey;


--Grouping of customers by annual income levels
SELECT CASE 
        WHEN AnnualIncome < 50000 THEN 'Below 50k'
        WHEN AnnualIncome BETWEEN 50000 AND 100000 THEN '50k-100k'
        ELSE 'Above 100k'
       END AS IncomeGroup, COUNT(*) AS CustomerCount
FROM Customers
GROUP BY CASE 
        WHEN AnnualIncome < 50000 THEN 'Below 50k'
        WHEN AnnualIncome BETWEEN 50000 AND 100000 THEN '50k-100k'
        ELSE 'Above 100k'
       END;


--To analyze the statistical distribution of the educational levels of the clients
SELECT EducationLevel, COUNT(*) AS CustomerCount
FROM Customers
GROUP BY EducationLevel;
